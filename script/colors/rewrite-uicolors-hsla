#!/usr/bin/env ruby

require "bundler/setup"
require "json"
require "color_conversion"
require "active_support/deprecation"
require "active_support/deprecator"
require "active_support/core_ext/string"

Color = ColorConversion::Color

puts "/* This file is generated by script/rewrite-uicolors-hsla.rb */"
puts "/* Credit: Color palettes by https://uicolors.app */"
puts ":root {"

color_json = JSON.parse(File.read(File.join(File.dirname(__FILE__), "./data/uicolors-palette-hex.json")))

color_json.sort_by { |color, _| color }.each do |color, weight_hex_pairs|
  puts "\s\s/* #{color} */"
  weight_hex_pairs.each do |weight, hex|
    hsl = Color.new(hex).hsl
    hsla_string = "hsla(#{hsl[:h]}, #{hsl[:s]}%, #{hsl[:l]}%, 1)"
    puts "\s\s--color-#{color.dasherize}-#{weight}: #{hsla_string};"
  end
  puts ""
end

puts "}"
